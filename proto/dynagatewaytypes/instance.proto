syntax = "proto3";

option go_package = "go.dynactionize.com/dynagatewaytypes";
option java_package = "com.dynactionize.dynagatewaytypes";
option java_generic_services = true;

import "dynagatewaytypes/general_types.proto";

package dynagatewaytypes;

message NewInstanceReq {
    AuthToken token = 1;
    oneof action {
        int64 action_id = 2;
        string name = 3;
    }
    oneof topology {
        int64 topology_id = 4;
        TopologySequence sequence = 5;
    }
    ValueList values = 6;
}

message InstanceBatch {
    oneof action {
        int64 action_id = 1;
        string name = 2;
    }
    oneof topology {
        int64 topology_id = 3;
        TopologySequence sequence = 4;
    }
    repeated ValueList values = 5;
}

message BatchNewInstancesReq {
    AuthToken token = 1;
    repeated InstanceBatch batches = 2;
}

message ReadInstanceReq {
    AuthToken token = 1;
    int64 id = 2;
    bool return_action_id = 3;
    bool return_topology_id = 4;
}

message GetInstanceReq {
    AuthToken token = 1;
    int64 id = 2;

    // Maarten: Remove? I think this does not make sense, unless this is an exact match on all elements
    // of an instance...
    ValueList values = 3;
}

message DeleteInstanceReq {
    AuthToken token = 1;
    int64 id = 2;
}


message InstanceRes {
    Status status = 1;
    int64 id = 2;
    ValueList values = 3;
    int64 action_id = 4;
    int64 topology_id = 5;
}


service InstanceService {
    rpc New(NewInstanceReq) returns(Status);
    rpc BatchNew(BatchNewInstancesReq) returns(Status);
    rpc Get(GetInstanceReq) returns(InstanceRes);
    rpc Update(UpdateInstanceReq) returns(Status);
    rpc Delete(DeleteInstanceReq) returns(Status);
}